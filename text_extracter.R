
getwd()


library(tabulizer)
library(pdftables)
library(pdftools)
library(stringr)
library(xlsx)

setwd("D:/Users/850047630/Desktop/IRI Transforming data/prophetModel/")

tx <- pdf_text("Measures.pdf")
tx2 <- unlist(str_split(tx, "[\\r\\n]+"))
tx3 <- str_split_fixed(str_trim(tx2), "\\s{2,}", 5)
write.csv(tx3, file="ds.csv")
################
install.packages("docxtractr")
library(docxtractr)
library(tibble)
library(dplyr)

# current version
packageVersion("docxtractr")
doc <- read_docx("Measuresguide.docx")
num<-docx_tbl_count(doc)
docx_describe_tbls(doc)
docx_extract_tbl(doc, 1)
docx_extract_tbl(doc)
docx_extract_tbl(doc, header=FALSE)
docx_tbl_count(doc)
tbls <- docx_extract_all_tbls(doc)
docx_extract_all_tbls(doc, preserve=TRUE)
tbls[[1]]
m<-t(tbls[[1]])
x<-t(tbls[])
#write.csv(m,file = "preserve.csv")



x1<-t(tbls[[1]])
#17*2
x2<-t(tbls[[2]])
x3<-t(tbls[[3]])
x4<-t(tbls[[4]])
x5<-t(tbls[[5]])
x6<-t(tbls[[6]])
x7<-t(tbls[[7]])
x8<-t(tbls[[8]])
x10<-t(tbls[[10]])
x13<-t(tbls[[13]])
x14<-t(tbls[[14]])
x15<-t(tbls[[15]])
x16<-t(tbls[[16]])
x17<-t(tbls[[17]])
x19<-t(tbls[[19]])

x20<-t(tbls[[20]])
x21<-t(tbls[[21]])
x22<-t(tbls[[22]])
x25<-t(tbls[[25]])
x31<-t(tbls[[31]])
x37<-t(tbls[[37]])
x62<-t(tbls[[62]])
x63<-t(tbls[[63]])
x64<-t(tbls[[64]])
x75<-t(tbls[[75]])
x79<-t(tbls[[79]])
x80<-t(tbls[[80]])
x93<-t(tbls[[93]])
x94<-t(tbls[[94]])
x95<-t(tbls[[95]])
x96<-t(tbls[[96]])
x97<-t(tbls[[97]])
x99<-t(tbls[[99]])
x102<-t(tbls[[102]])
x103<-t(tbls[[103]])

data17<-rbind(x2,x3,x4,x5,x6,x7,x8,x10,x13,x14,x15,x16,x17,x19,x20,x22,
              x25,x31,x37,x62,x63,x64,x75,x79,x80,x93,x94,x95,x96,x97,
              x99,x102,x103)
#19/83
x1<-t(tbls[[1]])
x9<-t(tbls[[9]])
x11<-t(tbls[[11]])
x12<-t(tbls[[12]])
x18<-t(tbls[[18]])
x23<-t(tbls[[23]])
x24<-t(tbls[[24]])
x26<-t(tbls[[26]])
x27<-t(tbls[[27]])
x28<-t(tbls[[28]])
x29<-t(tbls[[29]])
x30<-t(tbls[[30]])
x33<-t(tbls[[33]])
x34<-t(tbls[[34]])
x35<-t(tbls[[35]])
x38<-t(tbls[[38]])
x42<-t(tbls[[42]])
x43<-t(tbls[[43]])
x44<-t(tbls[[44]])
x47<-t(tbls[[47]])
x52<-t(tbls[[52]])
x55<-t(tbls[[55]])
x56<-t(tbls[[56]])
x57<-t(tbls[[57]])
x58<-t(tbls[[58]])
x61<-t(tbls[[61]])
x65<-t(tbls[[65]])
x67<-t(tbls[[67]])
x69<-t(tbls[[69]])
x70<-t(tbls[[70]])
x71<-t(tbls[[71]])
x72<-t(tbls[[72]])
x76<-t(tbls[[76]])
x82<-t(tbls[[82]])
x86<-t(tbls[[86]])
x89<-t(tbls[[89]])
x90<-t(tbls[[90]])
x92<-t(tbls[[92]])
x100<-t(tbls[[100]])
x101<-t(tbls[[101]])
x104<-t(tbls[[104]])
x105<-t(tbls[[105]])
x106<-t(tbls[[106]])
x107<-t(tbls[[107]])
x108<-t(tbls[[108]])
x112<-t(tbls[[112]])

data19<-rbind(x1,x9,x11,x12,x18,x23,x24,x26,x27,x28,x29,x30,x33,x34,x35,
              x38,x42,x43,x44,x47,x52,x55,x56,x57,x58,x61,x65,x67,x69,x70,
              x71,x72,x76,x82,x86,x89,x90,x92,x100,x101,x104,x105,x106,x107,
              x108,x112)

data17<-as.data.frame(data17)              
data19<-as.data.frame(data19)   
newdata<-rbind.fill(data17,data19)
